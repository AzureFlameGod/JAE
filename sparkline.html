<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript" src="https://underscorejs.org/underscore.js"></script>

    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="result"></div>
<table id="table-sparkline">
    <thead>
    <tr>
        <th onclick="sortTable(0)">Building</th>
        <th onclick="sortTable(1)">Total Devices</th>
        <th>Devices per Day</th>
        <th></th>
        <th>Change From Previous Day</th>
    </tr>
    <tr>
        <th></th>
        <th></th>
        <td/>
        <td></td>
        <td/>
    </tr>

    </thead>
    <tbody id="tbody-sparkline">
    <tr>
        <td align="left">Bachman</td>
        <td align="center">12713</td>
        <td data-sparkline="202, 133, 112, 105, 338, 255, 226"/>
        <td></td>
        <td data-sparkline="-467, 318, -82, 4583, -1212, -1084; column"/>
    </tr>
    <tr>
        <td align="left">Kuykendall N.</td>
        <td align="center">14630</td>
        <td data-sparkline="221, 117, 29, 45, 669, 836, 616"/>
        <td></td>
        <td data-sparkline="-104, -88, 16, 624, 167, -220; column"/>
    </tr>
    <tr>
        <td align="left">Kuykendall W.</td>
        <td align="center">28298</td>
        <td data-sparkline="297, 134, 91, 131, 1078, 1209, 1137"/>
        <td></td>
        <td data-sparkline="-163, -43, 40, 947, 131, -72; column"/>
    </tr>
    <tr>
        <td align="left">Geophysics</td>
        <td align="center">28298</td>
        <td data-sparkline="251, 142, 69, 74, 867, 954, 820"/>
        <td></td>
        <td data-sparkline="-109, -73, 5, 793, 87, -134; column"/>
    </tr>
    <tr>
        <td align="left">Physical Science</td>
        <td align="center">14041</td>
        <td data-sparkline="98, 62, 38, 63, 615, 567, 590"/>
        <td></td>
        <td data-sparkline="-36, -24, 25, 552, -48, 23; column"/>
    </tr>
    <tr>
        <td align="left">Physical Science</td>
        <td align="center">14041</td>
        <td data-sparkline="98, 62, 38, 63, 615, 567, 590"/>
        <td></td>
        <td data-sparkline="-36, -24, 25, 552, -48, 23; column"/>
    </tr>
    <tr>
        <td align="left">Sinclair Libary</td>
        <td align="center">28638</td>
        <td data-sparkline="390, 192, 166, 135, 765, 780, 707"/>
        <td></td>
        <td data-sparkline="-198, -26, -31, 630, 15, -73; column"/>
    </tr>
    <tr>
        <td align="left">Administrative</td>
        <td align="center">18607</td>
        <td data-sparkline="302, 143, 97, 102, 494, 520, 485"/>
        <td></td>
        <td data-sparkline="-159, -46, 5, 392, 26, -35; column"/>
    </tr>
    <tr>
        <td align="left">Parking Kiosk</td>
        <td align="center">22908</td>
        <td data-sparkline="422, 168, 132, 120, 529, 587, 517"/>
        <td></td>
        <td data-sparkline="-254, -36, -12, 409, 58, -70; column"/>
    </tr>
    <tr>
        <td align="left">Parking Kiosk</td>
        <td align="center">19856</td>
        <td data-sparkline="240, 180, 54, 71, 694, 894, 897"/>
        <td></td>
        <td data-sparkline="-60, -126, 17, 623, 200, 3; column"/>
    </tr>
    <tr>
        <td align="left">Hawai'i Hale</td>
        <td align="center">24560</td>
        <td data-sparkline="332, 196, 73, 71, 1014, 1122, 1052"/>
        <td></td>
        <td data-sparkline="-136, -123, -2, 943, 108, -70; column"/>
    </tr>
    <tr>
        <td align="left">QLCC</td>
        <td align="center">26244</td>
        <td data-sparkline="408, 200, 129, 97, 837, 831, 724"/>
        <td></td>
        <td data-sparkline="-208, -71, -32, 740, -6, -107; column"/>
    </tr>
    <tr>
        <td align="left">Kennedy Theatre</td>
        <td align="center">13279</td>
        <td data-sparkline="188, 140, 82, 245, 267, 319, 265"/>
        <td></td>
        <td data-sparkline="-48, -58, 163, 22, 52, -54; column"/>
    </tr>
    <tr>
        <td align="left">Hamilton Library</td>
        <td align="center">24532</td>
        <td data-sparkline="364, 123, 63, 92, 954, 870, 958"/>
        <td></td>
        <td data-sparkline="-241, -60, 29, 862, -84, 88; column"/>
    </tr>
    <tr>
        <td align="left">Keller Hall</td>
        <td align="center">32644</td>
        <td data-sparkline="396, 117, 71, 94, 1439, 1364, 1447"/>
        <td></td>
        <td data-sparkline="-279, -46, 23, 1345, -75, 83; column"/>
    </tr>
    <tr>
        <td align="left">Webster Hall</td>
        <td align="center">19978</td>
        <td data-sparkline="1611, 1144, 1462, 1380, 5963, 4751, 3667"/>
        <td></td>
        <td data-sparkline="-467, 318, -82, 4583, -1212, -1084; column"/>
    </tr>
    <tr>
        <td align="left">East-West Kiosk</td>
        <td align="center">23092</td>
        <td data-sparkline="319, 208, 184, 197, 562, 573, 467"/>
        <td></td>
        <td data-sparkline="-111, -24, 13, 365, 11, -106; column"/>
    </tr>
    <tr>
        <td align="left">Oceanography</td>
        <td align="center">06460</td>
        <td data-sparkline="103, 40, 20, 26, 226, 286, 244"/>
        <td></td>
        <td data-sparkline="-63, -20, 6, 200, 60, -42; column"/>
    </tr>
    <tr>
        <td align="left">Watanabe</td>
        <td align="center">22088</td>
        <td data-sparkline="311, 141, 85, 187, 734, 713, 663"/>
        <td></td>
        <td data-sparkline="-170, -56, 102, 547, -21, -50; column"/>
    </tr>
    <tr>
        <td align="left">Art Building</td>
        <td align="center">35222</td>
        <td data-sparkline="427, 198, 127, 136, 1402, 1353, 1347"/>
        <td></td>
        <td data-sparkline="-229, -71, 9, 1266, -49, -6; column"/>
    </tr>
    <tr>
        <td align="left">Law School</td>
        <td align="center">33874</td>
        <td data-sparkline="445, 267, 199, 188, 768, 848, 821"/>
        <td></td>
        <td data-sparkline="-178, -68, -11, 580, 80, -27; column"/>
    </tr>
    <tr>
        <td align="left">Law Libary</td>
        <td align="center">41839</td>
        <td data-sparkline="520, 329, 269, 239, 934, 1038, 1011"/>
        <td></td>
        <td data-sparkline="-191, -60, -30, 695, 104, -27; column"/>
    </tr>
    <tr>
        <td align="left">Korean Studies</td>
        <td align="center">24613</td>
        <td data-sparkline="351, 155, 128, 167, 618, 661, 620"/>
        <td></td>
        <td data-sparkline="-196, -27, 39, 451, 43, -41; column"/>
    </tr>
    <tr>
        <td align="left">Recreation Center</td>
        <td align="center">19590</td>
        <td data-sparkline="278, 142, 142, 139, 563, 496, 483"/>
        <td></td>
        <td data-sparkline="-136, 0, -3, 424, -67, -13; column"/>
    </tr>
    <tr>
        <td align="left">Campus Center</td>
        <td align="center">44078</td>
        <td data-sparkline="916, 435, 299, 197, 1256, 1315, 1328"/>
        <td></td>
        <td data-sparkline="-481, -136, -102, 1059, 59, 13; column"/>
    </tr>
    <tr>
        <td align="left">Gateway House</td>
        <td align="center">42550</td>
        <td data-sparkline="377, 497, 291, 381, 759, 1447, 863"/>
        <td></td>
        <td data-sparkline="120, -206, 90, 378, 688, -584; column"/>
    </tr>
</table>
</body>
</html>
<script>
    /**
     * Create a constructor for sparklines that takes some sensible defaults and merges in the individual
     * chart options. This function is also available from the jQuery plugin as $(element).highcharts('SparkLine').
     */

        Highcharts.SparkLine = function (a, b, c) {
            var hasRenderToArg = typeof a === 'string' || a.nodeName,
                options = arguments[hasRenderToArg ? 1 : 0],
                defaultOptions = {
                    chart: {
                        renderTo: (options.chart && options.chart.renderTo) || this,
                        backgroundColor: null,
                        borderWidth: 0,
                        type: 'area',
                        margin: [2, 0, 2, 0],
                        width: 120,
                        height: 20,
                        style: {
                            overflow: 'visible'
                        },

                        // small optimalization, saves 1-2 ms each sparkline
                        skipClone: true
                    },
                    title: {
                        text: ''
                    },
                    credits: {
                        enabled: false
                    },
                    xAxis: {
                        labels: {
                            enabled: false
                        },
                        title: {
                            text: null
                        },
                        startOnTick: false,
                        endOnTick: false,
                        tickPositions: []
                    },
                    yAxis: {
                        endOnTick: false,
                        startOnTick: false,
                        labels: {
                            enabled: false
                        },
                        title: {
                            text: null
                        },
                        tickPositions: [0]
                    },
                    legend: {
                        enabled: false
                    },
                    tooltip: {
                        backgroundColor: null,
                        borderWidth: 0,
                        shadow: false,
                        useHTML: true,
                        hideDelay: 0,
                        shared: true,
                        padding: 0,
                        positioner: function (w, h, point) {
                            return {x: point.plotX - w / 2, y: point.plotY - h};
                        }
                    },
                    plotOptions: {
                        series: {
                            animation: false,
                            lineWidth: 1,
                            shadow: false,
                            states: {
                                hover: {
                                    lineWidth: 1
                                }
                            },
                            marker: {
                                radius: 1,
                                states: {
                                    hover: {
                                        radius: 2
                                    }
                                }
                            },
                            fillOpacity: 0.25
                        },
                        column: {
                            negativeColor: '#910000',
                            borderColor: 'silver'
                        }
                    }
                };

            options = Highcharts.merge(defaultOptions, options);

            return hasRenderToArg ?
                new Highcharts.Chart(a, options, c) :
                new Highcharts.Chart(options, b);
        };

        var start = +new Date(),
            $tds = $('td[data-sparkline]'),
            fullLen = $tds.length,
            n = 0;

        // Creating 153 sparkline charts is quite fast in modern browsers, but IE8 and mobile
        // can take some seconds, so we split the input into chunks and apply them in timeouts
        // in order avoid locking up the browser process and allow interaction.
        function doChunk() {
            var time = +new Date(),
                i,
                len = $tds.length,
                $td,
                stringdata,
                arr,
                data,
                chart;

            for (i = 0; i < len; i += 1) {
                $td = $($tds[i]);
                stringdata = $td.data('sparkline');
                arr = stringdata.split('; ');
                data = $.map(arr[0].split(', '), parseFloat);
                chart = {};

                if (arr[1]) {
                    chart.type = arr[1];
                }
                $td.highcharts('SparkLine', {
                    series: [{
                        data: data,
                        pointStart: 1
                    }],
                    tooltip: {
                        headerFormat: '<span style="font-size: 10px">' + $td.parent().find('th').html() + ', Day {point.x}:</span><br/>',
                        pointFormat: '<b>{point.y}</b> Devices'
                    },
                    chart: chart
                });

                n += 1;

                // If the process takes too much time, run a timeout to allow interaction with the browser
                if (new Date() - time > 500) {
                    $tds.splice(0, i + 1);
                    setTimeout(doChunk, 0);
                    break;
                }

            }
        }

        doChunk();


    function sortTable(n) {
        console.log(n);
        var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
        table = document.getElementById("table-sparkline");
        switching = true;
        // Set the sorting direction to ascending:
        dir = "asc";
        /* Make a loop that will continue until
        no switching has been done: */
        while (switching) {
            // Start by saying: no switching is done:
            switching = false;
            rows = table.rows;
            /* Loop through all table rows (except the
            first, which contains table headers): */
            for (i = 1; i < (rows.length - 1); i++) {
                // Start by saying there should be no switching:
                shouldSwitch = false;
                /* Get the two elements you want to compare,
                one from current row and one from the next: */
                x = rows[i].getElementsByTagName("TD")[n];
                y = rows[i + 1].getElementsByTagName("TD")[n];
                /* Check if the two rows should switch place,
                based on the direction, asc or desc: */
                if (dir == "asc") {
                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                        // If so, mark as a switch and break the loop:
                        shouldSwitch = true;
                        break;
                    }
                } else if (dir == "desc") {
                    if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                        // If so, mark as a switch and break the loop:
                        shouldSwitch = true;
                        break;
                    }
                }
            }
            if (shouldSwitch) {
                /* If a switch has been marked, make the switch
                and mark that a switch has been done: */
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
                // Each time a switch is done, increase this count by 1:
                switchcount ++;
            } else {
                /* If no switching has been done AND the direction is "asc",
                set the direction to "desc" and run the while loop again. */
                if (switchcount == 0 && dir == "asc") {
                    dir = "desc";
                    switching = true;
                }
            }
        }
    }
</script>

</script>